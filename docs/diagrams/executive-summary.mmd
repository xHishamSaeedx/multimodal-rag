flowchart TB
    subgraph Frontend[" "]
        UI["Frontend UI<br/>(Search & Chat Portal)"]
    end

    subgraph Backend[" "]
        API["Backend API Layer<br/>(Query Routing & Control)"]
    end

    subgraph Services[" "]
        Hybrid["Hybrid Search Engine<br/>(Keyword + Vector Search)"]
        Multimodal["Multimodal AI Services<br/>(Text, Images, Tables)"]
        GraphAPI["(Optional) Graph API<br/>(Relationships, Impact)"]
    end

    subgraph Processing[" "]
        AnswerGen["AI Answer Generator<br/>(LLM + Evidence + Safety)"]
        Response["Final Response<br/>(Answer + Sources + Media)"]
    end

    subgraph Storage["DATA & STORAGE LAYER"]
        RawDocs["Raw Documents<br/>(PDF, PPT, etc)"]
        ProcessedDocs["Processed Docs<br/>(Text/Images)"]
        SearchIndex["Search Indexes<br/>(Vector + BM25)"]
        KG["Knowledge Graph (Opt.)<br/>Entities + Relations"]
    end

    subgraph MLOps["MLOps"]
        Monitoring["Monitoring & Analytics<br/>(User feedback, quality)"]
        ModelMgmt["Model Management<br/>(Registry & Versions)"]
        Pipelines["Automated Pipelines<br/>(Ingestion, Indexing)"]
    end

    %% Main flow
    UI --> API
    API --> Hybrid
    API --> Multimodal
    API --> GraphAPI
    
    Hybrid --> AnswerGen
    Multimodal --> AnswerGen
    GraphAPI --> AnswerGen
    
    AnswerGen --> Response

    %% Storage connections
    Hybrid -.->|reads| SearchIndex
    Multimodal -.->|reads| ProcessedDocs
    Multimodal -.->|reads| SearchIndex
    GraphAPI -.->|reads| KG
    AnswerGen -.->|reads| ProcessedDocs
    
    ProcessedDocs -.->|from| RawDocs
    SearchIndex -.->|from| RawDocs
    KG -.->|from| RawDocs

    %% MLOps connections
    Monitoring -.->|monitors| AnswerGen
    ModelMgmt -.->|manages| AnswerGen
    Pipelines -.->|processes| RawDocs
    Pipelines -.->|updates| ProcessedDocs
    Pipelines -.->|updates| SearchIndex

    %% Styling
    classDef frontend fill:#e1f5ff,stroke:#01579b,stroke-width:2px
    classDef backend fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef service fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef processing fill:#e8f5e9,stroke:#1b5e20,stroke-width:2px
    classDef storage fill:#fce4ec,stroke:#880e4f,stroke-width:2px
    classDef mlops fill:#fff9c4,stroke:#f57f17,stroke-width:2px

    class UI frontend
    class API backend
    class Hybrid,Multimodal,GraphAPI service
    class AnswerGen,Response processing
    class RawDocs,ProcessedDocs,SearchIndex,KG storage
    class Monitoring,ModelMgmt,Pipelines mlops

